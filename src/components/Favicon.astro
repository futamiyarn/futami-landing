<script lang="ts" is:inline>
	let status = 'active';
	let theme = '';

	const darkSheme = window.matchMedia('(prefers-color-scheme: dark)');

	const changeTheme = () =>
		darkSheme.matches ? (theme = 'dark') : (theme = 'light');
	const changeFavicon = () => {
		const visibility = document.visibilityState == 'visible';

		const change_fav = visibility ? 'active' : `inactive-${theme}`;

		const favicons = Array.from(document.getElementsByClassName('favicon'));

		favicons.forEach(
			(favicon) => (favicon.href = favicon.href.replace(status, change_fav))
		);

		status = change_fav;
	};

	darkSheme.onchange = () => changeTheme();
	window.addEventListener('visibilitychange', () => changeFavicon());

	changeTheme();
	changeFavicon();
</script>

<link
	class="favicon"
	rel="apple-touch-icon"
	sizes="180x180"
	href="/favicon/active/apple-touch-icon.png"
/>
<link
	class="favicon"
	rel="icon"
	type="image/png"
	sizes="32x32"
	href="/favicon/active/favicon-32x32.png"
/>
<link
	class="favicon"
	rel="icon"
	type="image/png"
	sizes="16x16"
	href="/favicon/active/favicon-16x16.png"
/>
<link class="favicon" rel="manifest" href="/favicon/active/site.webmanifest" />
